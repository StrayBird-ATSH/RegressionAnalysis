---
title: "Lab 8 Regression"
author: "Chen Wang, Junke Wang, Zhuozhi Xiong"
date: "due 11/27/19"
output: 
  pdf_document: 
    keep_md: true
    keep_tex: true
---

# Together as a class:

We are first going to install and load packages that we will need.

1. Install and load both the `modelr` package and the `openintro` package. Load the `tidyverse` package. 

```{r}
install.packages('modelr')
install.packages('openintro')
install.packages("tidyverse")
library(modelr)
library(openintro)
library(tidyverse)
```


For this problem we will be using the data set called `gpa` from the `openintro` package. We are interest in association between the number of hours of sleep a student gets and their gpas. 

2. Make a scatter plot and describe the association that you see. 

3. Create the linear regression model for this relationship between hours of sleep and GPA. We are regressing `gpa` onto `hours of sleep` Call this model `gpa_model`. 

\newpage
4. Find the correlation of this regression line and give the estimated $\beta$ values.

5. Interpret the $\hat{\beta}$ values. There are 2. 






\newpage
6. Add the predicted values of GPA and the Residuals to the data frame `gpa` using the `add_predictions()` and `add_residuals()` functions from the `modelr` package. 

```{r}
gpa<-gpa %>% 
  add_predictions(gpa_model) %>% 
  add_residuals(gpa_model)
```



7. Now we want to check the conditions needed to use the least squares regression line. Create a qqplot and a residual plots in order to check the conditions. Are the conditions meet? Are there any outliers? 

1 - independence of data

2 - linear relationship of GPA and hours of sleep


4 - constant variability

```{r}
gpa %>% 
  ggplot(aes(x=sleepnight,y=resid))+
  geom_point()+
  geom_hline(yintercept=0)
```

All of our assumptions check out. We can use linear regression.

\newpage

8. Conduct a hypothesis test to see if there is an association between how much sleep a student gets and their GPA. What can we conclude? 

$$H_0: \beta_1 = 0 $$
(The population slope is 0. There is no relationship between hours of sleep and GPA.)

$$H_A: \beta_1 \ne 0$$
(The population slope is not 0. There is a relationship between hours of sleep and GPA.)


```{r}
gpa_model %>% 
  summary()
```


Our test statistic T = 0.0445. Our p-value is 0.658. Because our p-value>0.05, we fail to reject the null hyposis. We cannot say if there is a relationship between hours of sleep and GPA.
\newpage
# On your own:

In this problem, we will be using the `babies` data set from the `openintro` package. information about the data set can be found by running the following code in an `r` chunk: `?babies`. We are interested in finding out how the length of gestation(`gestation`), the age of the mother(`age`), the height of the mother(`height`), the mother's weight(`weight`), and whether or not this was the mother's first pregnacy (`parity`) are related to how much the baby will weight at birth (`bwt`). 


1.Load the data and save it as `baby`.


2. Create the linear regression model that regresses `bwt` the variables mentioned above. Print out the summary. 


3. Interpret the coefficients for `gestation` and `parity`.


4. Does the intercept value have any meaning in context?



5. What is the Multiple $R^2$ value for this model.


\newpage
6. Add the residuals and predicted values to the data frame.

7. Create a residual plot and a qqplot. Comment on whether or not the conditions are met to use the model you found in part 2. 


\newpage
8. Obtain a 95% confidence interval for the coefficient on `gestation` and `age`. Interpret both confidence intervals.  




